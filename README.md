Данный код, обновляет добавляет и удаляет таблы.  А вторая его задача(основная) регенирация и перестроение таблиц после добаваления в новой записи в таблицу, которая выступает накопителем для запросов.
Суть следующая. Документ приходящий из 1С содержит в себе код станка, сосотояние и время начала состояния. 

Но из за особбеностей системы 1С она никак не может регистрирвоать время окончания состояния, поэтому в рамках проекта было решено, что окончанием одного состояния, является начало следующего сотсояния.
Но тут есть один нюанс, что бзер со стороны 1С может изменить время начаал состояния, и что важно, любого состояние за прошедшие двое суток, а значит тем самы он моежт менять и окончания других состояний 
иле же вообще делать окончание состостояния другим. Пример: Состояние 10 закрывает состояние 11, время начала состояния 11 стало меньше начала состояния 9 и теперь состояние 11 закрывает состояние 9,
а состояние 10 закрывает состояние 12, ерунда не правда ли? Но 1С не был бы самим собой если бы что то было не так). В конечном итоге я насчитал порядка 60 вариантов развития 
событий(важно помнить, что менятся может так же код станка, а значит запись должна переехать в другую таблицу). То есть была в одной а стала в другой , ведь записи, которые относятся к одному станку, 
находятся в ожной таблицу, а записи относящиеся к другому станку, соотвественно хранятся в другой, и при удаление в одной таблице и добавление в другую надо менять и обрабатывать кучу сценариев
в двух таблицах. 


Но я решил не обрабатывать эту кучу сценариев, взамен я храню запросы в одной общей таблице, но при это так же имею маленькие таблицы для каждого из станков. И каждый раз при пополнение 
общей таблицы, перестариваю с определенного отрезка маленькие таблички , соблюдая верную логику и не рискую не потерять сценарий, а так же 
это я сделал быстрее чем бы описывал все сценарии))


## В версии 1.2 расширен набор возможных исключений
#Добавлены исключения для приему запросов с датой начала не менее вух суток от текущего времени. 
#Довлены исключение указывающее что именно не хватает в теле запроса.


